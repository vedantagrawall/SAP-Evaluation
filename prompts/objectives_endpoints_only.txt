# Objectives and Endpoints Evaluation Prompt

You are evaluating a Generated SAP against an Original SAP for a clinical trial.

---

## DOCUMENTS PROVIDED

- **ORIGINAL SAP**: Human-written reference SAP
- **GENERATED SAP**: Auto-generated SAP being evaluated
- **PROTOCOL**: Source of truth when discrepancies arise

---

## YOUR TASK

Verify that all objectives and endpoints from the Original SAP are listed in the Generated SAP. The evaluation checks for missing items, contradictions, and extra items.

**For objectives:** Extract each objective with its full description.
**For endpoints:** Extract each endpoint with only its parameter description (one-liner). Do not extract definition details, analysis methods, or any other information about the endpoint.

---

## EVALUATION APPROACH

### PHASE 1: EXTRACTION

Extract all objectives and endpoints from ALL THREE documents:

1. Read the ENTIRE **Original SAP** and extract all objectives and endpoints.
2. Read the ENTIRE **Generated SAP** and extract all objectives and endpoints.
3. Read the ENTIRE **Protocol** and extract all objectives and endpoints.

For each objective, extract the full statement. For each endpoint, extract only the endpoint name and its parameter description. Each objective is one element. Each endpoint is one element.

### PHASE 2: COMPARISON TABLE

Using the three extracted lists, evaluate the Generated SAP:
create a table with rows being all the extracted elements from all the three documents with overlapping components de-duped (rely to exact match de-duping or the same semantic meaning) but be sure not to miss any unique element.
columns should be documents. each grid block should indicate whether the given element was present in the given document.

color code the following:

**Missing items:** Any objective or endpoint present in the Original SAP but absent from the Generated SAP.
- If also present in Protocol → classification = `missing_required`
- If only in Original SAP (not in Protocol) → classification = `acceptable_difference`

**Contradictions:** Any objective or endpoint in the Generated SAP that contradicts the Original SAP or Protocol.

**Extra items:** Any objective or endpoint in the Generated SAP that is not present in the Original SAP.
- If also present in Protocol → neutral (not a problem)
- If contradicts Original SAP or Protocol → problem

### PHASE 3: VERIFICATION

Verify that all items from all three extraction lists have been accounted for in the comparison.

---

## OUTPUT FORMAT

Output MUST be a markdown document with the following structure:

### 1. Comparison Table

Use this exact table format:

| # | Type | Objective / Endpoint | Original SAP | Generated SAP | Protocol | Classification |
|---|------|----------------------|:------------:|:-------------:|:--------:|----------------|
| 1 | Primary Objective | [description] | ✅ | ✅ | ✅ | Present |
| 2 | Secondary Endpoint | [description] | ✅ | ❌ | ✅ | missing_required |

Column definitions:
- **#**: Row number
- **Type**: One of: Primary Objective, Secondary Objective, Primary Endpoint, Secondary Endpoint, Safety Endpoint, PK Endpoint, QoL Endpoint
- **Objective / Endpoint**: The de-duped element description
- **Original SAP / Generated SAP / Protocol**: ✅ if present, ❌ if absent
- **Classification**: One of:
  - `Present` — found in Generated SAP
  - `missing_required` — missing from Generated SAP but in both Original SAP AND Protocol
  - `acceptable_difference` — missing from Generated SAP but only in Original SAP (not in Protocol)
  - `extra` — in Generated SAP but not in Original SAP
  - `contradiction` — Generated SAP contradicts Original SAP or Protocol

### 2. Summary Sections

After the table, include these sections:

#### Missing from Generated SAP
List any items classified as `missing_required` or `acceptable_difference` with a brief explanation.

#### Contradictions
List any items where the Generated SAP contradicts the Original SAP or Protocol. Quote the conflicting text from each document.

#### Extra in Generated SAP
List any items in the Generated SAP not found in the Original SAP.

#### Overall Assessment
A brief summary of the evaluation result.

---

OUTPUT SHOULD BE THE VERIFIED AND COMPLETE COMPARISON TABLE NOT MISSING A SINGLE UNIQUE ELEMENT.

